MAP
  IMAGETYPE                                             PNG
  EXTENT                                                0 0 800000 800000
  SIZE                                                  2800 2800
  IMAGECOLOR                                            255 255 255
  FONTSET                                               "/ms4w/Apache/cgi-bin/fonts/fontset"

  WEB
    IMAGEPATH                                           "/ms4w/tmp/ms_tmp/"
    IMAGEURL                                            "/ms_tmp/"
    METADATA
      "wms_title"                                       "Designation Species Density Map"
      "wms_onlineresource"                              "http://nbngis-a.nerc-lancaster.ac.uk/mapserver/DesignationSpeciesDensityWMS?"
      "wms_srs"                                         "EPSG:29903 EPSG:27700 EPSG:4326 EPSG:3857"
      "wms_enable_request"                              "*"
    END
  END
  
  PROJECTION
    "init=epsg:27700"
  END

  LAYER
    NAME                                                "3"
    TYPE                                                POLYGON
    STATUS                                              OFF
    CONNECTIONTYPE                                      PLUGIN
    PLUGIN                                              "msplugin_mssql2008.dll"
    CONNECTION                                          "Server=NBNSQL-B;Database=NBNWarehouse;uid=nbngis;pwd=Lo9ijnhy6tfc;Integrated Security=True"
    PROCESSING                                          "CLOSE_CONNECTION=DEFER"

    METADATA
      "wms_title"                                       "3"
      'default_userKey'                                 '0'
    END

    VALIDATION
      'designationKey'                                  '^[A-Z0-9.()/_\-]+$'
      'userKey'                                         '^[0-9]+$'
    END

    DATA                                                "geom from (SELECT geom, species, gridRef FROM vw_DesignationSpeciesDensityMap WHERE code = '%designationKey%' AND userKey = '%userKey%' AND resolutionID = 1) AS foo USING UNIQUE gridRef USING SRID=4326"

    PROJECTION
      "init=epsg:4326"
    END
        
    CLASS
      NAME                                              "10km bkt 1"
      EXPRESSION                                        ([SPECIES] = 1)
          
      STYLE
        COLOR                                           255 255 128
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 2"
      EXPRESSION                                        ([SPECIES] = 2)
          
      STYLE
        COLOR                                           255 241 115
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 3"
      EXPRESSION                                        ([SPECIES] = 3)
          
      STYLE
        COLOR                                           252 227 101
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 4"
      EXPRESSION                                        ([SPECIES] >= 4 AND [SPECIES] <= 5)
          
      STYLE
        COLOR                                           252 214 88
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 5"
      EXPRESSION                                        ([SPECIES] >= 6 AND [SPECIES] <= 10)
          
      STYLE
        COLOR                                           249 199 75
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 6"
      EXPRESSION                                        ([SPECIES] >= 11 AND [SPECIES] <= 15)
          
      STYLE
        COLOR                                           247 186 64
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 7"
      EXPRESSION                                        ([SPECIES] >= 16 AND [SPECIES] <= 20)
          
      STYLE
        COLOR                                           245 174 51
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 8"
      EXPRESSION                                        ([SPECIES] >= 21 AND [SPECIES] <= 35)
          
      STYLE
        COLOR                                           232 153 42
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 9"
      EXPRESSION                                        ([SPECIES] >= 36 AND [SPECIES] <= 50)
          
      STYLE
        COLOR                                           209 127 33
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 10"
      EXPRESSION                                        ([SPECIES] >= 51 AND [SPECIES] <= 75)
          
      STYLE
        COLOR                                           189 101 25
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 11"
      EXPRESSION                                        ([SPECIES] >= 76 AND [SPECIES] <= 100)
          
      STYLE
        COLOR                                           166 77 18
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 12"
      EXPRESSION                                        ([SPECIES] >= 101 AND [SPECIES] <= 250)
          
      STYLE
        COLOR                                           147 55 12
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 13"
      EXPRESSION                                        ([SPECIES] >= 251 AND [SPECIES] <= 500)
          
      STYLE
        COLOR                                           128 33 6
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "10km bkt 14"
      EXPRESSION                                        ([SPECIES] > 500)
          
      STYLE
        COLOR                                           107 0 0
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END
  END

  LAYER
    NAME                                                "2"
    TYPE                                                POLYGON
    STATUS                                              OFF
    CONNECTIONTYPE                                      PLUGIN
    PLUGIN                                              "msplugin_mssql2008.dll"
    CONNECTION                                          "Server=NBNSQL-A;Database=NBNWarehouse;uid=nbnimporter;pwd=Lo9ijnhy6tfc;Integrated Security=True"
    PROCESSING                                          "CLOSE_CONNECTION=DEFER"

    METADATA
      "wms_title"                                       "2"
      'default_userKey'                                 '0'
    END

    VALIDATION
      'designationKey'                                  '^[A-Z0-9.()/_\-]+$'
      'userKey'                                         '^[0-9]+$'
    END

    DATA                                                "geom from (SELECT geom, species, gridRef FROM vw_DesignationSpeciesDensityMap WHERE code = '%designationKey%' AND userKey = '%userKey%' AND resolutionID = 2) AS foo USING UNIQUE gridRef USING SRID=4326"

    PROJECTION
      "init=epsg:4326"
    END
        
    CLASS
      NAME                                              "2km bkt 1"
      EXPRESSION                                        ([SPECIES] = 1)
          
      STYLE
        COLOR                                           255 255 128
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 2"
      EXPRESSION                                        ([SPECIES] = 2)
          
      STYLE
        COLOR                                           255 241 115
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 3"
      EXPRESSION                                        ([SPECIES] = 3)
          
      STYLE
        COLOR                                           252 227 101
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 4"
      EXPRESSION                                        ([SPECIES] = 4)
          
      STYLE
        COLOR                                           252 214 88
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 5"
      EXPRESSION                                        ([SPECIES] = 5)
          
      STYLE
        COLOR                                           249 199 75
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 6"
      EXPRESSION                                        ([SPECIES] >= 6 AND [SPECIES] <= 7)
          
      STYLE
        COLOR                                           247 186 64
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 7"
      EXPRESSION                                        ([SPECIES] >= 8 AND [SPECIES] <= 10)
          
      STYLE
        COLOR                                           245 174 51
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 8"
      EXPRESSION                                        ([SPECIES] >= 11 AND [SPECIES] <= 15)
          
      STYLE
        COLOR                                           232 153 42
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 9"
      EXPRESSION                                        ([SPECIES] >= 16 AND [SPECIES] <= 20)
          
      STYLE
        COLOR                                           209 127 33
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 10"
      EXPRESSION                                        ([SPECIES] >= 21 AND [SPECIES] <= 25)
          
      STYLE
        COLOR                                           189 101 25
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 11"
      EXPRESSION                                        ([SPECIES] >= 26 AND [SPECIES] <= 30)
          
      STYLE
        COLOR                                           166 77 18
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 12"
      EXPRESSION                                        ([SPECIES] >= 31 AND [SPECIES] <= 50)
          
      STYLE
        COLOR                                           147 55 12
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 13"
      EXPRESSION                                        ([SPECIES] >= 51 AND [SPECIES] <= 100)
          
      STYLE
        COLOR                                           128 33 6
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "2km bkt 14"
      EXPRESSION                                        ([SPECIES] > 100)
          
      STYLE
        COLOR                                           107 0 0
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END
  END

  LAYER
    NAME                                                "1"
    TYPE                                                POLYGON
    STATUS                                              OFF
    CONNECTIONTYPE                                      PLUGIN
    PLUGIN                                              "msplugin_mssql2008.dll"
    CONNECTION                                          "Server=NBNSQL-A;Database=NBNWarehouse;uid=nbnimporter;pwd=Lo9ijnhy6tfc;Integrated Security=True"
    PROCESSING                                          "CLOSE_CONNECTION=DEFER"

    METADATA
      "wms_title"                                       "1"
      'default_userKey'                                 '0'
    END

    VALIDATION
      'designationKey'                                  '^[A-Z0-9.()/_\-]+$'
      'userKey'                                         '^[0-9]+$'
    END

    DATA                                                "geom from (SELECT geom, species, gridRef FROM vw_DesignationSpeciesDensityMap WHERE code = '%designationKey%' AND userKey = '%userKey%' AND resolutionID = 3) AS foo USING UNIQUE gridRef USING SRID=4326"

    PROJECTION
      "init=epsg:4326"
    END
        
    CLASS
      NAME                                              "1km bkt 1"
      EXPRESSION                                        ([SPECIES] = 1)
          
      STYLE
        COLOR                                           255 255 128
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 2"
      EXPRESSION                                        ([SPECIES] = 2)
          
      STYLE
        COLOR                                           255 241 115
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 3"
      EXPRESSION                                        ([SPECIES] = 3)
          
      STYLE
        COLOR                                           252 227 101
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 4"
      EXPRESSION                                        ([SPECIES] = 4)
          
      STYLE
        COLOR                                           252 214 88
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 5"
      EXPRESSION                                        ([SPECIES] = 5)
          
      STYLE
        COLOR                                           249 199 75
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 6"
      EXPRESSION                                        ([SPECIES] >= 6 AND [SPECIES] <= 7)
          
      STYLE
        COLOR                                           247 186 64
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 7"
      EXPRESSION                                        ([SPECIES] >= 8 AND [SPECIES] <= 10)
          
      STYLE
        COLOR                                           245 174 51
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 8"
      EXPRESSION                                        ([SPECIES] >= 11 AND [SPECIES] <= 15)
          
      STYLE
        COLOR                                           232 153 42
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 9"
      EXPRESSION                                        ([SPECIES] >= 16 AND [SPECIES] <= 20)
          
      STYLE
        COLOR                                           209 127 33
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 10"
      EXPRESSION                                        ([SPECIES] >= 21 AND [SPECIES] <= 25)
          
      STYLE
        COLOR                                           189 101 25
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 11"
      EXPRESSION                                        ([SPECIES] >= 26 AND [SPECIES] <= 30)
          
      STYLE
        COLOR                                           166 77 18
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 12"
      EXPRESSION                                        ([SPECIES] >= 31 AND [SPECIES] <= 50)
          
      STYLE
        COLOR                                           147 55 12
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 13"
      EXPRESSION                                        ([SPECIES] >= 51 AND [SPECIES] <= 100)
          
      STYLE
        COLOR                                           128 33 6
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "1km bkt 14"
      EXPRESSION                                        ([SPECIES] > 100)
          
      STYLE
        COLOR                                           107 0 0
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END
  END
  
  LAYER
    NAME                                                "0"
    TYPE                                                POLYGON
    STATUS                                              OFF
    CONNECTIONTYPE                                      PLUGIN
    PLUGIN                                              "msplugin_mssql2008.dll"
    CONNECTION                                          "Server=NBNSQL-A;Database=NBNWarehouse;uid=nbnimporter;pwd=Lo9ijnhy6tfc;Integrated Security=True"
    PROCESSING                                          "CLOSE_CONNECTION=DEFER"

    METADATA
      "wms_title"                                       "0"
      'default_userKey'                                 '0'
    END

    VALIDATION
      'designationKey'                                  '^[A-Z0-9.()/_\-]+$'
      'userKey'                                         '^[0-9]+$'
    END

    DATA                                                "geom from (SELECT geom, species, gridRef FROM vw_DesignationSpeciesDensityMap WHERE code = '%designationKey%' AND userKey = '%userKey%' AND resolutionID = 4) AS foo USING UNIQUE gridRef USING SRID=4326"

    PROJECTION
      "init=epsg:4326"
    END
        
    CLASS
      NAME                                              "100m bkt 1"
      EXPRESSION                                        ([SPECIES] = 1)
          
      STYLE
        COLOR                                           255 255 128
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 2"
      EXPRESSION                                        ([SPECIES] = 2)
          
      STYLE
        COLOR                                           255 241 115
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 3"
      EXPRESSION                                        ([SPECIES] = 3)
          
      STYLE
        COLOR                                           252 227 101
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 4"
      EXPRESSION                                        ([SPECIES] = 4)
          
      STYLE
        COLOR                                           252 214 88
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 5"
      EXPRESSION                                        ([SPECIES] = 5)
          
      STYLE
        COLOR                                           249 199 75
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 6"
      EXPRESSION                                        ([SPECIES] = 6)
          
      STYLE
        COLOR                                           247 186 64
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 7"
      EXPRESSION                                        ([SPECIES] = 7)
          
      STYLE
        COLOR                                           245 174 51
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 8"
      EXPRESSION                                        ([SPECIES] = 8)
          
      STYLE
        COLOR                                           232 153 42
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 9"
      EXPRESSION                                        ([SPECIES] = 9)
          
      STYLE
        COLOR                                           209 127 33
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 10"
      EXPRESSION                                        ([SPECIES] = 10)
          
      STYLE
        COLOR                                           189 101 25
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 11"
      EXPRESSION                                        ([SPECIES] >= 11 AND [SPECIES] <= 15)
          
      STYLE
        COLOR                                           166 77 18
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 12"
      EXPRESSION                                        ([SPECIES] >= 16 AND [SPECIES] <= 20)
          
      STYLE
        COLOR                                           147 55 12
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 13"
      EXPRESSION                                        ([SPECIES] >= 21 AND [SPECIES] <= 50)
          
      STYLE
        COLOR                                           128 33 6
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END

    CLASS
      NAME                                              "100m bkt 14"
      EXPRESSION                                        ([SPECIES] > 50)
          
      STYLE
        COLOR                                           107 0 0
        OUTLINECOLOR                                    0 0 0
        WIDTH                                           0.5
      END
    END
  END
END