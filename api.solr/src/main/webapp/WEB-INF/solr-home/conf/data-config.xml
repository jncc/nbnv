<dataConfig>
    <dataSource type="JdbcDataSource"
                driver="com.microsoft.sqlserver.jdbc.SQLServerDriver"
                url="jdbc:sqlserver://nbnsql-a.nerc-lancaster.ac.uk;databaseName=NBNWarehouse" 
                user="NBNImporter"
                password="Ecowaswashere9"/>
    <document name="nbn-gateway">
        <entity name="taxon" query="Select t.*, trc.gatewayRecordCount from TaxonData t Left join TaxonRecordCountData trc ON trc.pTaxonVersionKey = t.pTaxonVersionKey" transformer="TemplateTransformer">	  
            <field column="record_id" template="TAXON-${taxon.taxonVersionKey}" />
            <field column="record_type" template="taxon" />
        </entity>
        <entity name="designation" query="Select * From DesignationData" transformer="TemplateTransformer">
            <field column="record_id" template="DESIGNATION-${designation.code}" />
            <field column="record_type" template="designation" />
        </entity>
        <entity name="gridsquarefeature" query="Select geom.STCentroid().STX AS location_0_coordinate, geom.STCentroid().STY AS location_1_coordinate,* From GridSquareFeatureData" transformer="TemplateTransformer">
            <field column="record_id" template="FEATURE-${gridsquarefeature.label}" />
            <field column="record_type" template="gridsquarefeature" />
            <field column="name" template="${gridsquarefeature.label}" />
        </entity>
        <entity name="siteboundaryfeature" query="Select geom.STCentroid().STX AS location_0_coordinate, geom.STCentroid().STY AS location_1_coordinate, sb.siteBoundaryDatasetKey as datasetKey, sbf.* From SiteBoundaryFeatureData sbf Inner Join SiteBoundaryData sb on sbf.id = sb.featureID" transformer="TemplateTransformer">
            <field column="record_id" template="FEATURE-${siteboundaryfeature.identifier}" />
            <field column="record_type" template="siteboundaryfeature" />
            <field column="name" template="${siteboundaryfeature.label}" />
        </entity>
        <entity name="organisation" query="Select * From OrganisationData" transformer="TemplateTransformer">
            <field column="record_id" template="ORGANISATION-${organisation.id}" />
            <field column="record_type" template="organisation" />
        </entity>
        <entity name="dataset" 
                query="Select lower(typeName) as [typeNameLower],* From DatasetData" 
                deltaImportQuery="Select lower(typeName) as [typeNameLower],* From DatasetData where [key]='${dih.delta.key}'" 
                deltaQuery="Select [key] From DatasetData where metadataLastEdited &gt; '${dih.last_index_time}'"
                transformer="TemplateTransformer">            
            <field column="record_id" template="DATASET-${dataset.key}" />
            <field column="record_type" template="${dataset.typeNameLower}dataset" />
            <field column="name" template="${dataset.title}" />
        </entity>
    </document>
</dataConfig>
